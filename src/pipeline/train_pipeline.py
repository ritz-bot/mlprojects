#contains code for all training pipeline